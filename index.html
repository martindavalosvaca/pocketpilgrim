<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PocketPilgrim - Find Peace Through Scripture</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAwIDI5MzQuNjIiPgogIDxkZWZzPgogICAgPHN0eWxlPgogICAgICAuY2xzLTEgewogICAgICAgIGZpbGw6ICNmZmY7CiAgICAgIH0KICAgIDwvc3R5bGU+CiAgPC9kZWZzPgogIDxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEyOTcuMzEsMTE4NC4wMWwtLjQ5LTIuMDVjLS4xNi42OC0uMzIsMS4zNy0uNDgsMi4wNS0yNy4xNCwxMTUuMjYtMTE1LjcsMjAzLjk1LTIzMC45MiwyMzEuMjRsLTIuNDYuNThjLjgxLjE5LDEuNjMuMzksMi40NC41OCwxMTUuMDksMjcuMjUsMjAzLjU5LDExNS43NSwyMzAuODUsMjMwLjg0bC41OCwyLjQ0Yy4xOS0uODEuMzktMS42Mi41OC0yLjQ0LDI3LjI4LTExNS4yMywxMTUuOTctMjAzLjgxLDIzMS4yNC0yMzAuOTVsMi4wNC0uNDhjLS42OC0uMTYtMS4zNy0uMzItMi4wNS0uNDktMTE1LjQtMjcuMTctMjA0LjE2LTExNS45Mi0yMzEuMzMtMjMxLjMzWiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTE4NDcuNzIsMTI5Ny45NmMtMTc2LTM0Mi44MS01NDUuMTgtODg0LjY4LTc0OS41Ny0xMTc3LjE4bC03Ni41MS0xMDkuNDljLTEwLjUxLTE1LjA0LTMyLjc5LTE1LjA0LTQzLjMsMGwtNzYuNTEsMTA5LjQ5QzY5Ny40NCw0MTMuMjQsMzI4LjMxLDk1NS4wOCwxNTIuMjMsMTI5OC4wMWMtMTYzLjUzLDMxOC45My0yMzIuMTIsODA3LjA1LTE2LjcyLDExNzguNjMsMTEzLjYsMTk1Ljk2LDQwNC40Myw0NjUuNjYsODU4Ljk0LDQ1Ny44MSwwLDAsNTk1LjM0LDE1LjkxLDg3MC4wNS00NTcuODEsMjE1LjQ0LTM3MS41MiwxNDYuNzktODU5LjY5LTE2Ljc2LTExNzguNjhaTTE2NTcuMjYsMjM1Ni41MWMtNTcuMzcsOTguOTctMTM3LjUxLDE3Ni4zMy0yMzkuMjIsMjMyLjMsMTIuNjEtODAuNDMsMjYuNDEtMjQ2LjM4LTY2LjUxLTM1OS4yNi0xMjYuMzItMTUzLjQ2LTM3MS42NS0xNzguMzgtNDYxLjg4LTI2MS4yMy04Ni40Ni03OS4zOS00Ni41OC0xNTYuMDIsMjIwLjQzLTI1MC45MSwxOS45OC03LjEsMzAuNTgtMjkuMDUsMjMuNzctNDkuMTMtNS45Mi0xNy40Ni0yMy4yMi0yOC40NC00MS41MS0yNi4xNC04Ny43LDExLjA0LTMzNC43Niw1My44Ny00MzMuNjUsMTkzLjQ4LTEyMS4yMywxNzEuMTQsMTA4LjM2LDM0NS41OSwyODQuNjgsNDExLjAyLDE3Ni4zMiw2NS40MiwyNjYuMTksMTY5LjUyLDIwOC45MSwyOTMuNDYtNTAuNzcsMTA5Ljg3LTI3My4yLDE0My42Mi00NjcuNjUsOTUuNTItMTUxLjkzLTU1LjU5LTI2Ni40MS0xNDguODctMzQxLjkyLTI3OS4xMS0xNjkuMTgtMjkxLjg3LTEwNi44Ni02OTYuNjMsMjIuNjEtOTQ5LjE1LDE0NC42MS0yODEuNjQsNDI5LjM1LTcwOS42NCw2MzQuNjYtMTAwNy44NiwyMDUuMzIsMjk4LjI1LDQ5MC4wOSw3MjYuMjcsNjM0LjYyLDEwMDcuNzgsMTI5LjUxLDI1Mi42LDE5MS44Myw2NTcuMzYsMjIuNjUsOTQ5LjIzWiIvPgo8L3N2Zz4=">

  <style>
    /* Reset */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* CSS Variables */
    :root {
      --primary: #3B82F6;
      --primary-dark: #1D4ED8;
      --primary-darker: #1E40AF;
      --secondary: #10B981;
      --secondary-dark: #059669;
      --white: #FFFFFF;
      --white-90: rgba(255, 255, 255, 0.9);
      --white-80: rgba(255, 255, 255, 0.8);
      --white-70: rgba(255, 255, 255, 0.7);
      --white-50: rgba(255, 255, 255, 0.5);
      --white-30: rgba(255, 255, 255, 0.3);
      --white-20: rgba(255, 255, 255, 0.2);
      --white-15: rgba(255, 255, 255, 0.15);
      --white-10: rgba(255, 255, 255, 0.1);
      --black-80: rgba(0, 0, 0, 0.8);
      --blue-light: #E0F2FE;
      --blue-lighter: #BAE6FD;
      --blue-alpha-30: rgba(147, 197, 253, 0.3);
      --blue-alpha-50: rgba(147, 197, 253, 0.5);
      
      --radius: 16px;
      --radius-lg: 20px;
      --radius-full: 50%;
      --transition: 0.3s ease;
      --header-height: 80px;
      --container-max: 1200px;
      --chat-max: 800px;
    }

    /* Base Styles */
    body {
      font-family: system-ui, -apple-system, sans-serif;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary) 0%, #1E40AF 50%, #1E3A8A 100%);
      background-attachment: fixed;
      color: var(--white);
      overflow-x: hidden;
    }

    /* Layout Components */
    .gradient-overlay {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, 
        rgba(59, 130, 246, 0.9) 0%, 
        rgba(30, 64, 175, 0.95) 25%,
        rgba(30, 58, 138, 0.9) 50%,
        rgba(15, 23, 42, 0.8) 75%,
        rgba(2, 6, 23, 0.85) 100%
      );
      z-index: -1;
    }

    .floating-elements {
      position: fixed;
      inset: 0;
      z-index: -1;
      overflow: hidden;
    }

    .floating-circle {
      position: absolute;
      border-radius: var(--radius-full);
      background: rgba(147, 197, 253, 0.1);
      backdrop-filter: blur(10px);
      animation: float 20s infinite linear;
    }

    .floating-circle:nth-child(1) {
      width: 80px;
      height: 80px;
      top: 20%;
      left: 10%;
    }

    .floating-circle:nth-child(2) {
      width: 120px;
      height: 120px;
      top: 60%;
      right: 15%;
      animation-delay: -7s;
    }

    .floating-circle:nth-child(3) {
      width: 60px;
      height: 60px;
      bottom: 30%;
      left: 20%;
      animation-delay: -14s;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 1rem 2rem;
      backdrop-filter: blur(20px);
      background: var(--white-10);
      border-bottom: 1px solid var(--white-10);
      transition: var(--transition);
    }

    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: var(--container-max);
      margin: 0 auto;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      font-size: 1.25rem;
      color: var(--white);
      text-decoration: none;
      cursor: pointer;
    }

    .logo-icon {
      width: 24px;
      height: 24px;
    }

    .nav-links {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .nav-button {
      background: var(--white-20);
      border: 1px solid var(--white-30);
      color: var(--white);
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.9rem;
    }

    .nav-button:hover {
      background: var(--white-30);
      transform: translateY(-1px);
    }

    .donate-nav-btn {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
      border: none;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .donate-nav-btn:hover {
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    .donate-nav-btn.highlight {
      animation: pulse 2s ease-in-out 3;
    }

    /* Landing Page */
    .landing-page {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 2rem;
      padding-top: 120px;
      text-align: center;
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .landing-page.hidden {
      opacity: 0;
      transform: translateY(-50px);
      pointer-events: none;
    }

    .hero-content {
      max-width: var(--chat-max);
      margin: 0 auto;
    }

    .hero-title {
      font-size: clamp(2.5rem, 6vw, 3rem);
      font-weight: 700;
      margin-bottom: 1.5rem;
      line-height: 1.1;
      background: linear-gradient(135deg, var(--white) 0%, var(--blue-light) 50%, var(--blue-lighter) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-subtitle {
      font-size: clamp(1.25rem, 4vw, 1.5rem);
      margin-bottom: 3rem;
      color: var(--white-90);
      line-height: 1.4;
    }

    .hero-input-container {
      max-width: 600px;
      margin: 0 auto 3rem;
      position: relative;
    }

    .hero-input, .chat-input {
      width: 100%;
      padding: 1.5rem 2rem;
      font-size: 1.125rem;
      border: 2px solid var(--blue-alpha-30);
      border-radius: var(--radius-lg);
      background: rgba(59, 130, 246, 0.1);
      color: var(--white);
      outline: none;
      transition: var(--transition);
      resize: none;
      min-height: 60px;
      font-family: inherit;
    }

    .hero-input::placeholder, .chat-input::placeholder {
      color: var(--white-50);
    }

    .hero-input:focus, .chat-input:focus {
      border-color: var(--blue-alpha-50);
      background: rgba(59, 130, 246, 0.15);
      box-shadow: 0 8px 12px rgba(59, 130, 246, 0.15);
    }

    .input-button {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: var(--white);
      border: none;
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .input-button:hover {
      transform: translateY(-50%) translateY(-1px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
    }

    .loading {
      display: none;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
    }

    .loading.show {
      display: flex;
    }

    .loading-dots {
      display: flex;
      gap: 3px;
    }

    .loading-dot {
      width: 4px;
      height: 4px;
      border-radius: var(--radius-full);
      background: var(--white);
      animation: loadingDot 1.4s infinite ease-in-out;
    }

    .loading-dot:nth-child(2) { animation-delay: 0.2s; }
    .loading-dot:nth-child(3) { animation-delay: 0.4s; }

    /* Example Cards */
    .examples-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
      max-width: var(--chat-max);
      margin: 0 auto 3rem;
    }

    .example-card {
      background: rgba(59, 130, 246, 0.15);
      backdrop-filter: blur(20px);
      border: 1px solid var(--blue-alpha-30);
      border-radius: var(--radius);
      padding: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
      text-align: left;
    }

    .example-card:hover {
      background: rgba(59, 130, 246, 0.25);
      border-color: var(--blue-alpha-50);
      transform: translateY(-4px);
      box-shadow: 0 10px 40px rgba(59, 130, 246, 0.3);
    }

    .example-card h3 {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--blue-light);
    }

    .example-card p {
      color: var(--white-90);
      font-size: 0.9rem;
      line-height: 1.4;
    }

    /* Stats */
    .stats-section {
      display: flex;
      justify-content: center;
      gap: 3rem;
      margin: 2rem 0 4rem;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: var(--white);
      display: block;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--white-70);
      margin-top: 0.25rem;
    }

    /* Chat Interface */
    .chat-interface {
      display: none;
      flex-direction: column;
      height: 100vh;
      padding-top: var(--header-height);
      opacity: 0;
      transition: opacity 0.8s ease;
    }

    .chat-interface.active {
      display: flex;
      opacity: 1;
    }

    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: var(--chat-max);
      margin: 0 auto;
      width: 100%;
      padding: 2rem;
      min-height: 0;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem 0;
      margin-bottom: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .message {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      animation: messageSlideIn 0.4s ease-out;
    }

    .message.user {
      align-items: flex-end;
    }

    .message.assistant {
      align-items: flex-start;
    }

    .message-content {
      flex: 1;
      max-width: 80%;
    }

    .message-bubble {
      padding: 1rem 1.25rem;
      border-radius: 18px;
      backdrop-filter: blur(20px);
      font-size: 0.95rem;
      line-height: 1.5;
      word-wrap: break-word;
    }

    .message.user .message-bubble {
      background: rgba(59, 130, 246, 0.2);
      border: 1px solid var(--blue-alpha-30);
      color: var(--white);
    }

    .message.assistant .message-bubble {
      background: var(--white-15);
      border: 1px solid var(--white-20);
      color: var(--white-90);
    }

    .message-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.5rem;
    }

    .message-footer .left-items {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .message-time {
      font-size: 0.75rem;
      color: var(--white-50);
    }

    .message-actions {
      display: flex;
      gap: 0.5rem;
      opacity: 0.6;
      transition: opacity var(--transition);
    }

    .message:hover .message-actions {
      opacity: 1;
    }

    .feedback-btn, .share-btn {
      background: none;
      border: none;
      color: var(--white-50);
      cursor: pointer;
      padding: 0.25rem;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      width: 24px;
      height: 24px;
    }

    .feedback-btn:hover, .share-btn:hover {
      background: var(--white-10);
      color: var(--white-80);
    }

    .feedback-btn.active {
      color: var(--white);
      background: var(--white-20);
    }

    .feedback-btn.like.active {
      color: #10B981;
    }

    .feedback-btn.dislike.active {
      color: var(--white);
    }

    .share-icon {
      width: 14px;
      height: 14px;
    }

    .scripture-reference {
      font-style: italic;
      color: var(--white-90);
      margin-top: 0.5rem;
      font-size: 0.85rem;
    }

    /* Chat Input */
    .chat-input-container {
      position: sticky;
      bottom: 0;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border-radius: var(--radius-lg);
      padding: 1rem;
      border: 2px solid var(--blue-alpha-30);
      transition: var(--transition);
    }

    .chat-input-container.feedback-mode {
      border-color: var(--white);
      box-shadow: 0 0 20px var(--white-30);
    }

    .chat-input-row {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .chat-input {
      background: transparent;
      border: none;
      padding: 8px 0;
      font-size: 1rem;
      min-height: 40px;
      max-height: 120px;
      line-height: 1.4;
      flex: 1;
    }

    .chat-input:focus {
      background: transparent;
      border: none;
      box-shadow: none;
    }

    .send-button {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: var(--white);
      border: none;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      flex-shrink: 0;
    }

    .send-button:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }

    .send-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .send-icon {
      width: 18px;
      height: 18px;
    }

    /* Typing Indicator */
    .typing-indicator {
      display: none;
      justify-content: center;
      align-items: center;
      padding: 2rem 0;
    }

    .typing-indicator.show {
      display: flex;
    }

    .typing-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
    }

    .typing-text {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--white-90);
      font-size: 1rem;
      font-weight: 500;
      opacity: 0;
      animation: cycleText 9s infinite;
    }

    .typing-text:nth-child(1) { animation-delay: 0s; }
    .typing-text:nth-child(2) { animation-delay: 3s; }
    .typing-text:nth-child(3) { animation-delay: 6s; }

    .typing-icon {
      width: 20px;
      height: 20px;
    }

    .typing-dots {
      display: flex;
      gap: 6px;
      background: var(--white-15);
      padding: 1rem 2rem;
      border-radius: var(--radius-lg);
      backdrop-filter: blur(20px);
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      border-radius: var(--radius-full);
      background: var(--white-80);
      animation: typingDot 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) { animation-delay: 0.2s; }
    .typing-dot:nth-child(3) { animation-delay: 0.4s; }

    /* Footer */
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 1rem 2rem;
      text-align: center;
      background: rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--white-10);
      transition: var(--transition);
      z-index: 50;
    }

    .footer.hidden {
      transform: translateY(100%);
      opacity: 0;
    }

    .footer-text {
      font-size: 0.875rem;
      color: var(--white-70);
    }

    .footer-text a {
      color: var(--white-90);
      text-decoration: none;
    }

    /* Donation Modal */
    .donation-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
    }

    .donation-modal-overlay {
      position: absolute;
      inset: 0;
      background: var(--black-80);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .donation-modal-content {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.95) 0%, rgba(5, 150, 105, 0.95) 100%);
      border-radius: var(--radius-lg);
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      border: 2px solid rgba(167, 243, 208, 0.3);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    .donation-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2rem 2rem 1rem;
      border-bottom: 1px solid var(--white-20);
    }

    .donation-header h2 {
      color: var(--white);
      font-size: 1.5rem;
      font-weight: 600;
    }

    .donation-close {
      background: none;
      border: none;
      color: var(--white);
      font-size: 2rem;
      cursor: pointer;
      padding: 0;
      line-height: 1;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .donation-close:hover {
      opacity: 1;
    }

    .donation-body {
      padding: 2rem;
    }

    .donation-body > p {
      color: var(--white-90);
      font-size: 1.125rem;
      margin-bottom: 2rem;
      text-align: center;
      line-height: 1.5;
    }

    .donation-amounts {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .donation-amount {
      background: var(--white-10);
      border: 2px solid var(--white-20);
      border-radius: var(--radius);
      padding: 1rem;
      text-align: center;
      transition: var(--transition);
      cursor: pointer;
    }

    .donation-amount:hover {
      border-color: var(--white-50);
      background: var(--white-15);
    }

    .donation-amount .price {
      color: var(--white);
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .donation-amount p {
      color: var(--white-80);
      font-size: 0.8rem;
      margin: 0;
    }

    .donation-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .skip-btn {
      flex: 1;
      background: var(--white-10);
      color: var(--white);
      border: 2px solid var(--white-30);
      border-radius: 12px;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .skip-btn:hover {
      background: var(--white-20);
      border-color: var(--white-50);
    }

    .donation-footer {
      text-align: center;
      padding-top: 1rem;
      border-top: 1px solid var(--white-20);
    }

    .donation-footer p {
      color: var(--white-70);
      font-size: 0.85rem;
      margin: 0.25rem 0;
    }

    /* Mobile Icon Display */
    .nav-icon {
      display: none;
    }

    /* Animations */
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
      50% { transform: translateY(-20px) rotate(180deg); opacity: 0.6; }
    }

    @keyframes messageSlideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes loadingDot {
      0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); }
      40% { opacity: 1; transform: scale(1); }
    }

    @keyframes typingDot {
      0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); }
      40% { opacity: 1; transform: scale(1.2); }
    }

    @keyframes cycleText {
      0%, 20% { opacity: 1; transform: translateY(0); }
      25%, 100% { opacity: 0; transform: translateY(-10px); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5); }
      50% { transform: scale(1.05); box-shadow: 0 8px 30px rgba(16, 185, 129, 0.7); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header {
        padding: 1rem;
      }

      .logo {
        font-size: 0;
      }

      .logo-icon {
        width: 32px;
        height: 32px;
      }

      .nav-links {
        gap: 0.5rem;
      }

      .nav-button {
        width: 44px;
        height: 44px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .nav-text {
        display: none;
      }

      .nav-icon {
        display: block !important;
        width: 20px;
        height: 20px;
      }

      .landing-page {
        padding: 1rem;
        padding-top: 100px;
      }

      .hero-input-container {
        margin-bottom: 2rem;
      }

      .input-button {
        position: static;
        transform: none;
        width: 100%;
        margin-top: 1rem;
      }

      .examples-grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
      }

      .stats-section {
        gap: 2rem;
        flex-wrap: wrap;
      }

      .chat-container {
        padding: 1rem;
      }

      .message-content {
        max-width: 95%;
      }

      .footer {
        position: relative;
        margin-top: 3rem;
      }

      .footer.hidden {
        transform: none;
        opacity: 1;
        display: none;
      }

      .donation-buttons {
        flex-direction: column;
      }
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>

<body>
  <!-- Background Elements -->
  <div class="gradient-overlay"></div>
  <div class="floating-elements">
    <div class="floating-circle"></div>
    <div class="floating-circle"></div>
    <div class="floating-circle"></div>
  </div>

  <!-- Header -->
  <header class="header">
    <nav class="nav">
      <a href="#" class="logo" onclick="app.goHome()">
        <img class="logo-icon" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAwIDI5MzQuNjIiPgogIDxkZWZzPgogICAgPHN0eWxlPgogICAgICAuY2xzLTEgewogICAgICAgIGZpbGw6ICNmZmY7CiAgICAgIH0KICAgIDwvc3R5bGU+CiAgPC9kZWZzPgogIDxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEyOTcuMzEsMTE4NC4wMWwtLjQ5LTIuMDVjLS4xNi42OC0uMzIsMS4zNy0uNDgsMi4wNS0yNy4xNCwxMTUuMjYtMTE1LjcsMjAzLjk1LTIzMC45MiwyMzEuMjRsLTIuNDYuNThjLjgxLjE5LDEuNjMuMzksMi40NC41OCwxMTUuMDksMjcuMjUsMjAzLjU5LDExNS43NSwyMzAuODUsMjMwLjg0bC41OCwyLjQ0Yy4xOS0uODEuMzktMS42Mi41OC0yLjQ0LDI3LjI4LTExNS4yMywxMTUuOTctMjAzLjgxLDIzMS4yNC0yMzAuOTVsMi4wNC0uNDhjLS42OC0uMTYtMS4zNy0uMzItMi4wNS0uNDktMTE1LjQtMjcuMTctMjA0LjE2LTExNS45Mi0yMzEuMzMtMjMxLjMzWiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTE4NDcuNzIsMTI5Ny45NmMtMTc2LTM0Mi44MS01NDUuMTgtODg0LjY4LTc0OS41Ny0xMTc3LjE4bC03Ni41MS0xMDkuNDljLTEwLjUxLTE1LjA0LTMyLjc5LTE1LjA0LTQzLjMsMGwtNzYuNTEsMTA5LjQ5QzY5Ny40NCw0MTMuMjQsMzI4LjMxLDk1NS4wOCwxNTIuMjMsMTI5OC4wMWMtMTYzLjUzLDMxOC45My0yMzIuMTIsODA3LjA1LTE2LjcyLDExNzguNjMsMTEzLjYsMTk1Ljk2LDQwNC40Myw0NjUuNjYsODU4Ljk0LDQ1Ny44MSwwLDAsNTk1LjM0LDE1LjkxLDg3MC4wNS00NTcuODEsMjE1LjQ0LTM3MS41MiwxNDYuNzktODU5LjY5LTE2Ljc2LTExNzguNjhaTTE2NTcuMjYsMjM1Ni41MWMtNTcuMzcsOTguOTctMTM3LjUxLDE3Ni4zMy0yMzkuMjIsMjMyLjMsMTIuNjEtODAuNDMsMjYuNDEtMjQ2LjM4LTY2LjUxLTM1OS4yNi0xMjYuMzItMTUzLjQ2LTM3MS42NS0xNzguMzgtNDYxLjg4LTI2MS4yMy04Ni40Ni03OS4zOS00Ni41OC0xNTYuMDIsMjIwLjQzLTI1MC45MSwxOS45OC03LjEsMzAuNTgtMjkuMDUsMjMuNzctNDkuMTMtNS45Mi0xNy40Ni0yMy4yMi0yOC40NC00MS41MS0yNi4xNC04Ny43LDExLjA0LTMzNC43Niw1My44Ny00MzMuNjUsMTkzLjQ4LTEyMS4yMywxNzEuMTQsMTA4LjM2LDM0NS41OSwyODQuNjgsNDExLjAyLDE3Ni4zMiw2NS40MiwyNjYuMTksMTY5LjUyLDIwOC45MSwyOTMuNDYtNTAuNzcsMTA5Ljg3LTI3My4yLDE0My42Mi00NjcuNjUsOTUuNTItMTUxLjkzLTU1LjU5LTI2Ni40MS0xNDguODctMzQxLjkyLTI3OS4xMS0xNjkuMTgtMjkxLjg3LTEwNi44Ni02OTYuNjMsMjIuNjEtOTQ5LjE1LDE0NC42MS0yODEuNjQsNDI5LjM1LTcwOS42NCw2MzQuNjYtMTAwNy44NiwyMDUuMzIsMjk4LjI1LDQ5MC4wOSw3MjYuMjcsNjM0LjYyLDEwMDcuNzgsMTI5LjUxLDI1Mi42LDE5MS44Myw2NTcuMzYsMjIuNjUsOTQ5LjIzWiIvPgo8L3N2Zz4=" alt="PocketPilgrim">
        PocketPilgrim
      </a>
      
      <div class="nav-links">
        <button class="nav-button donate-nav-btn" onclick="app.showDonationModal()">
          <span class="nav-text">💚 Support Us</span>
          <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
        </button>
        <button class="nav-button start-nav-btn" onclick="app.startChat()" id="startChatBtn">
          <span class="nav-text">Start guidance</span>
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </button>
        <button class="nav-button start-nav-btn" onclick="app.newChat()" id="newChatBtn" style="display: none;">
          <span class="nav-text">New chat</span>
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </button>
      </div>
    </nav>
  </header>

  <!-- Landing Page -->
  <main class="landing-page" id="landingPage">
    <div class="hero-content">
      <h1 class="hero-title">Find peace through Scripture</h1>
      <p class="hero-subtitle">Get compassionate, Bible-grounded guidance by simply sharing what's on your heart - completely free</p>
      
      <div class="hero-input-container">
        <textarea 
          id="heroInput" 
          class="hero-input" 
          placeholder="Share what's weighing on your heart..."
          rows="1"
        ></textarea>
        <button class="input-button" onclick="app.handleLandingSubmit()">
          <span id="buttonText">Get guidance</span>
          <div class="loading" id="loading">
            <div class="loading-dots">
              <div class="loading-dot"></div>
              <div class="loading-dot"></div>
              <div class="loading-dot"></div>
            </div>
            Finding guidance...
          </div>
        </button>
      </div>

      <div class="examples-grid">
        <div class="example-card" onclick="app.useExample('I\'m feeling overwhelmed by work stress and deadlines')">
          <h3>💼 Work & Stress</h3>
          <p>"I'm feeling overwhelmed by work stress and deadlines"</p>
        </div>
        
        <div class="example-card" onclick="app.useExample('I\'m struggling to forgive someone who deeply hurt me')">
          <h3>💔 Forgiveness</h3>
          <p>"I'm struggling to forgive someone who deeply hurt me"</p>
        </div>
        
        <div class="example-card" onclick="app.useExample('I feel lost and don\'t know God\'s plan for my life')">
          <h3>🗺️ Purpose</h3>
          <p>"I feel lost and don't know God's plan for my life"</p>
        </div>
        
        <div class="example-card" onclick="app.useExample('I\'m grieving the loss of someone very close to me')">
          <h3>🕊️ Grief</h3>
          <p>"I'm grieving the loss of someone very close to me"</p>
        </div>
      </div>

      <div class="stats-section">
        <div class="stat">
          <span class="stat-number">10K+</span>
          <span class="stat-label">Conversations</span>
        </div>
        <div class="stat">
          <span class="stat-number">500+</span>
          <span class="stat-label">Bible Verses</span>
        </div>
        <div class="stat">
          <span class="stat-number">100%</span>
          <span class="stat-label">Free</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Chat Interface -->
  <div class="chat-interface" id="chatInterface">
    <div class="chat-container">
      <div class="chat-messages" id="chatMessages"></div>

      <div class="typing-indicator" id="typingIndicator">
        <div class="typing-container">
          <div class="typing-text">
            <svg class="typing-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <span>empathizing...</span>
          </div>
          <div class="typing-text">
            <svg class="typing-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="9"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <span>understanding...</span>
          </div>
          <div class="typing-text">
            <svg class="typing-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
            </svg>
            <span>responding...</span>
          </div>
          <div class="typing-dots">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        </div>
      </div>

      <div class="chat-input-container">
        <div class="chat-input-row">
          <textarea 
            id="chatInput" 
            class="chat-input" 
            placeholder="Share what's on your heart..."
            rows="1"
          ></textarea>
          <button class="send-button" id="sendButton" onclick="app.sendMessage()">
            <svg class="send-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer" id="footer">
    <p class="footer-text">
      AI-assisted spiritual guidance grounded in Scripture - Always free. 
      Not medical, legal, or mental health advice. 
      Crisis support: <a href="tel:988">Call 988</a>
    </p>
  </footer>

  <script>
    const app = (() => {
      // Configuration
      const CONFIG = {
        WEBHOOK_URL: 'https://alertahora.app.n8n.cloud/webhook/spiritual-advice',
        SCRIPTURE_VERSES: [
          '"Cast all your anxiety on him because he cares for you." - 1 Peter 5:7',
          '"Be still, and know that I am God." - Psalm 46:10',
          '"And we know that in all things God works for the good of those who love him." - Romans 8:28',
          '"Trust in the Lord with all your heart and lean not on your own understanding." - Proverbs 3:5',
          '"Peace I leave with you; my peace I give you." - John 14:27',
          '"The Lord is my shepherd, I lack nothing." - Psalm 23:1',
          '"Come to me, all you who are weary and burdened, and I will give you rest." - Matthew 11:28'
        ]
      };

      // State
      const state = {
        isInChatMode: false,
        messageCount: 0,
        waitingForFeedback: false,
        feedbackContext: null
      };

      // DOM Elements
      const dom = {};

      // Initialize DOM references
      const initDOM = () => {
        dom.landingPage = document.getElementById('landingPage');
        dom.chatInterface = document.getElementById('chatInterface');
        dom.footer = document.getElementById('footer');
        dom.heroInput = document.getElementById('heroInput');
        dom.chatInput = document.getElementById('chatInput');
        dom.chatMessages = document.getElementById('chatMessages');
        dom.sendButton = document.getElementById('sendButton');
        dom.typingIndicator = document.getElementById('typingIndicator');
        dom.startChatBtn = document.getElementById('startChatBtn');
        dom.newChatBtn = document.getElementById('newChatBtn');
        dom.buttonText = document.getElementById('buttonText');
        dom.loading = document.getElementById('loading');
      };

      // Utilities
      const generateSessionId = () => `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
      
      const getRandomScripture = () => CONFIG.SCRIPTURE_VERSES[Math.floor(Math.random() * CONFIG.SCRIPTURE_VERSES.length)];

      // Textarea Setup
      const setupTextarea = (textarea) => {
        textarea.addEventListener('input', function() {
          if (state.waitingForFeedback && textarea === dom.chatInput) {
            if (!this.value.startsWith('Feedback: ')) {
              this.value = 'Feedback: ' + this.value.replace(/^Feedback:\s*/, '');
              this.setSelectionRange(this.value.length, this.value.length);
            }
          }
          
          this.style.height = 'auto';
          this.style.height = Math.min(this.scrollHeight, 120) + 'px';
          
          if (textarea === dom.chatInput) {
            updateSendButton();
          }
        });

        textarea.addEventListener('keydown', function(e) {
          if (state.waitingForFeedback && textarea === dom.chatInput) {
            if (e.key === 'Backspace' && this.selectionStart <= 10) {
              e.preventDefault();
              return;
            }
          }
          
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            if (textarea === dom.heroInput) {
              handleLandingSubmit();
            } else {
              sendMessage();
            }
          }
        });
      };

      const updateSendButton = () => {
        const hasText = dom.chatInput.value.trim().length > 0;
        dom.sendButton.disabled = !hasText;
      };

      // UI Transitions
      const transitionToChat = (initialMessage = '') => {
        state.isInChatMode = true;
        
        dom.footer.classList.add('hidden');
        dom.landingPage.classList.add('hidden');
        dom.startChatBtn.style.display = 'none';
        dom.newChatBtn.style.display = 'block';
        
        setTimeout(() => {
          dom.landingPage.style.display = 'none';
          dom.chatInterface.classList.add('active');
          
          if (initialMessage) {
            dom.chatInput.value = initialMessage;
            updateSendButton();
            setTimeout(() => sendMessage(), 300);
          }
          
          dom.chatInput.focus();
        }, 400);
      };

      const goHome = () => {
        if (state.isInChatMode) {
          state.isInChatMode = false;
          state.messageCount = 0;
          
          dom.chatInterface.classList.remove('active');
          dom.chatMessages.innerHTML = '';
          dom.heroInput.value = '';
          dom.chatInput.value = '';
          dom.heroInput.style.height = 'auto';
          dom.chatInput.style.height = 'auto';
          
          if (dom.buttonText) dom.buttonText.style.display = 'inline';
          if (dom.loading) dom.loading.classList.remove('show');
          
          setTimeout(() => {
            dom.landingPage.style.display = 'flex';
            dom.landingPage.classList.remove('hidden');
            dom.footer.classList.remove('hidden');
            dom.startChatBtn.style.display = 'block';
            dom.newChatBtn.style.display = 'none';
          }, 100);
        }
      };

      // Message Creation
      const createMessage = (content, isUser = false, includeScripture = false) => {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'assistant'}`;
        
        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        
        const messageBubble = document.createElement('div');
        messageBubble.className = 'message-bubble';
        messageBubble.innerHTML = content;
        
        if (includeScripture) {
          const scripture = document.createElement('div');
          scripture.className = 'scripture-reference';
          scripture.innerHTML = getRandomScripture();
          messageBubble.appendChild(scripture);
        }
        
        const messageFooter = document.createElement('div');
        messageFooter.className = 'message-footer';
        
        const messageTime = document.createElement('div');
        messageTime.className = 'message-time';
        messageTime.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        if (!isUser) {
          const leftItems = document.createElement('div');
          leftItems.className = 'left-items';
          
          const shareBtn = createShareButton(messageDiv);
          leftItems.appendChild(shareBtn);
          leftItems.appendChild(messageTime);
          messageFooter.appendChild(leftItems);
          
          const messageActions = createFeedbackButtons(messageDiv);
          messageFooter.appendChild(messageActions);
        } else {
          messageFooter.appendChild(messageTime);
        }
        
        messageContent.appendChild(messageBubble);
        messageContent.appendChild(messageFooter);
        messageDiv.appendChild(messageContent);
        
        return messageDiv;
      };

      const createShareButton = (messageElement) => {
        const shareBtn = document.createElement('button');
        shareBtn.className = 'share-btn';
        shareBtn.onclick = () => handleShare(messageElement);
        shareBtn.innerHTML = `
          <svg class="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="18" cy="5" r="3"></circle>
            <circle cx="6" cy="12" r="3"></circle>
            <circle cx="18" cy="19" r="3"></circle>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
          </svg>
        `;
        return shareBtn;
      };

      const createFeedbackButtons = (messageElement) => {
        const messageActions = document.createElement('div');
        messageActions.className = 'message-actions';
        
        const likeBtn = document.createElement('button');
        likeBtn.className = 'feedback-btn like';
        likeBtn.setAttribute('aria-label', 'Thumbs up');
        likeBtn.onclick = () => handleFeedback(messageElement, 'like');
        likeBtn.innerHTML = `
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
          </svg>
        `;
        
        const dislikeBtn = document.createElement('button');
        dislikeBtn.className = 'feedback-btn dislike';
        dislikeBtn.setAttribute('aria-label', 'Feedback');
        dislikeBtn.onclick = () => handleFeedback(messageElement, 'dislike');
        dislikeBtn.style.cssText = 'font-size: 0.75rem; font-weight: normal; width: auto; padding: 0.25rem 0.5rem;';
        dislikeBtn.textContent = 'Feedback';
        
        messageActions.appendChild(likeBtn);
        messageActions.appendChild(dislikeBtn);
        
        return messageActions;
      };

      // Share Functionality
      const handleShare = (messageElement) => {
        const messageText = messageElement.querySelector('.message-bubble').textContent;
        const scripture = messageElement.querySelector('.scripture-reference');
        const scriptureText = scripture ? scripture.textContent : '';
        
        const shareText = `${messageText}\n\n${scriptureText}\n\nShared from PocketPilgrim - Find peace through Scripture`;
        
        if (navigator.share) {
          navigator.share({
            title: 'Spiritual Guidance from PocketPilgrim',
            text: shareText,
            url: window.location.href
          }).catch(() => {});
        } else {
          navigator.clipboard.writeText(shareText).then(() => {
            const shareBtn = messageElement.querySelector('.share-btn');
            const originalContent = shareBtn.innerHTML;
            shareBtn.innerHTML = `<svg class="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20,6 9,17 4,12"></polyline></svg>`;
            shareBtn.style.color = '#10B981';
            
            setTimeout(() => {
              shareBtn.innerHTML = originalContent;
              shareBtn.style.color = '';
            }, 2000);
          });
        }
      };

      // Feedback System
      const handleFeedback = (messageElement, type) => {
        const messageActions = messageElement.querySelector('.message-actions');
        const likeBtn = messageActions.querySelector('.like');
        const dislikeBtn = messageActions.querySelector('.dislike');
        const chatInputContainer = document.querySelector('.chat-input-container');
        
        likeBtn.classList.remove('active');
        dislikeBtn.classList.remove('active');
        
        if (type === 'like') {
          likeBtn.classList.add('active');
          if (dom.chatInput.value.startsWith('Feedback: ')) {
            dom.chatInput.value = '';
          }
          dom.chatInput.placeholder = "Share what's on your heart...";
          chatInputContainer.classList.remove('feedback-mode');
          state.waitingForFeedback = false;
        } else {
          dislikeBtn.classList.add('active');
          dom.chatInput.value = 'Feedback: ';
          dom.chatInput.placeholder = "What could have been better?";
          chatInputContainer.classList.add('feedback-mode');
          dom.chatInput.focus();
          dom.chatInput.setSelectionRange(dom.chatInput.value.length, dom.chatInput.value.length);
          state.waitingForFeedback = true;
          state.feedbackContext = messageElement.querySelector('.message-bubble').textContent;
        }
      };

      // Chat Functions
      const handleLandingSubmit = () => {
        const message = dom.heroInput.value.trim();
        if (!message) {
          dom.heroInput.focus();
          return;
        }

        dom.buttonText.style.display = 'none';
        dom.loading.classList.add('show');

        setTimeout(() => {
          transitionToChat(message);
        }, 800);
      };

      const startChat = () => {
        transitionToChat();
      };

      const newChat = () => {
        dom.chatMessages.innerHTML = '';
        dom.chatInput.value = '';
        dom.chatInput.style.height = 'auto';
        updateSendButton();
        state.messageCount = 0;
        dom.chatInput.focus();
      };

      const useExample = (exampleText) => {
        dom.heroInput.value = exampleText;
        dom.heroInput.style.height = 'auto';
        dom.heroInput.style.height = Math.min(dom.heroInput.scrollHeight, 120) + 'px';
        
        setTimeout(() => {
          handleLandingSubmit();
        }, 300);
      };

      const sendMessage = async () => {
        const message = dom.chatInput.value.trim();
        if (!message || dom.sendButton.disabled) return;

        const userMessage = createMessage(message, true);
        dom.chatMessages.appendChild(userMessage);

        dom.chatInput.value = '';
        dom.chatInput.style.height = 'auto';
        updateSendButton();

        if (state.waitingForFeedback && /^feedback:\s*/i.test(message)) {
          const payload = {
            kind: 'feedback',
            message,
            context: state.feedbackContext || null,
            timestamp: new Date().toISOString(),
            sessionId: generateSessionId()
          };

          try {
            await fetch(CONFIG.WEBHOOK_URL, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload)
            });
          } catch (err) {}

          state.waitingForFeedback = false;
          dom.chatInput.placeholder = "Share what's on your heart...";
          document.querySelector('.chat-input-container').classList.remove('feedback-mode');

          setTimeout(() => {
            const thankYouMessage = createMessage("Thank you for your feedback! It helps us improve our guidance for everyone.", false, false);
            dom.chatMessages.appendChild(thankYouMessage);
            dom.chatMessages.scrollTop = dom.chatMessages.scrollHeight;
          }, 300);

          return;
        }

        highlightDonateButton();

        dom.typingIndicator.classList.add('show');
        dom.chatMessages.scrollTop = dom.chatMessages.scrollHeight;

        await new Promise(resolve => setTimeout(resolve, 400));

        let response;
        try {
          response = await callWebhook(message);
        } finally {
          dom.typingIndicator.classList.remove('show');
        }

        const assistantMessage = createMessage(response, false, true);
        dom.chatMessages.appendChild(assistantMessage);
        dom.chatMessages.scrollTop = dom.chatMessages.scrollHeight;
      };

      const callWebhook = async (userMessage) => {
        try {
          const payload = {
            message: userMessage,
            timestamp: new Date().toISOString(),
            sessionId: generateSessionId()
          };
          
          const response = await fetch(CONFIG.WEBHOOK_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          return data.answerHtml || data.response || data.message || generateFallbackResponse(userMessage);
        } catch (error) {
          return generateFallbackResponse(userMessage);
        }
      };

      const generateFallbackResponse = (userMessage) => {
        const responses = {
          anxiety: "I hear the weight of anxiety in your words, and I want you to know that God sees your struggles and cares deeply for you. Anxiety can feel overwhelming, but remember that you are not meant to carry these burdens alone. The Lord invites us to cast all our anxieties on Him because He cares for us. This isn't just a nice sentiment—it's a powerful truth that can transform how we face our fears. Take time to breathe deeply and remember that God's love for you is unchanging, even in uncertain times.",
          forgiveness: "Forgiveness is one of the most challenging yet transformative acts we can embrace as followers of Christ. The pain you're feeling is valid, and God doesn't minimize the hurt you've experienced. Yet He calls us to forgive not because the offense was acceptable, but because forgiveness frees our own hearts from the prison of resentment. This doesn't mean trusting immediately or pretending the hurt didn't happen. Forgiveness is a process, often requiring us to choose it repeatedly. Ask God to help you take the first step, even if it's simply being willing to be willing to forgive.",
          purpose: "Feeling lost about God's plan for your life is more common than you might think, and it doesn't mean you're spiritually weak or lacking in faith. Sometimes God's plan unfolds slowly, like a path revealed one step at a time rather than showing us the entire journey at once. Trust that God is working in your life even when you can't see it clearly. Focus on being faithful in the small things before you, loving others well, and staying close to God through prayer and His Word. His plans for you are good, and He will guide your steps as you seek Him.",
          grief: "I'm so sorry for your loss. Grief is one of the deepest expressions of love—it shows how precious that person was to you. God doesn't ask you to rush through grief or pretend you're okay when you're not. He walks with you through this valley, and He understands sorrow intimately. It's okay to cry, to feel angry, or to struggle with questions. Take time to grieve, lean on your community, and remember that love never truly ends. The separation is temporary, but the love and memories you carry will always be part of you.",
          work: "Work stress can consume so much of our mental and emotional energy, leaving us feeling overwhelmed and depleted. God sees the pressure you're under and cares about every aspect of your life, including your work. Remember that your worth isn't defined by your productivity or success—you are beloved by God regardless of your performance. Try to set healthy boundaries where possible, take breaks to breathe and pray, and remember that most deadlines aren't as urgent as they feel in the moment. Trust God with the outcomes and do your best with peace in your heart.",
          default: "Thank you for sharing what's on your heart with me. I can sense that you're seeking God's guidance and comfort, and that takes courage. God sees exactly where you are right now—every struggle, every hope, every question you're carrying. He loves you deeply and wants to walk through this with you. Take time to be still in His presence, knowing that you are heard, you are seen, and you are loved. Whatever you're facing, you don't have to face it alone."
        };

        const message = userMessage.toLowerCase();
        
        if (message.includes('anxious') || message.includes('worry') || message.includes('stress')) {
          return responses.anxiety;
        } else if (message.includes('forgiv') || message.includes('hurt') || message.includes('angry')) {
          return responses.forgiveness;
        } else if (message.includes('purpose') || message.includes('lost') || message.includes('direction')) {
          return responses.purpose;
        } else if (message.includes('grief') || message.includes('death') || message.includes('loss')) {
          return responses.grief;
        } else if (message.includes('work') || message.includes('job') || message.includes('deadline')) {
          return responses.work;
        }
        return responses.default;
      };

      const highlightDonateButton = () => {
        state.messageCount++;
        
        if (state.messageCount <= 3 || state.messageCount % 10 === 0) {
          const donateBtn = document.querySelector('.donate-nav-btn');
          if (donateBtn) {
            donateBtn.classList.add('highlight');
            setTimeout(() => {
              donateBtn.classList.remove('highlight');
            }, 6000);
          }
        }
      };

      // Donation Modal
      const showDonationModal = () => {
        const modal = document.createElement('div');
        modal.className = 'donation-modal';
        modal.innerHTML = `
          <div class="donation-modal-overlay">
            <div class="donation-modal-content">
              <div class="donation-header">
                <h2>💚 Support PocketPilgrim</h2>
                <button class="donation-close" onclick="app.closeDonationModal()">&times;</button>
              </div>
              <div class="donation-body">
                <p>Your support helps us provide free spiritual guidance to everyone. Every donation, no matter the size, makes a difference in someone's life.</p>
                
                <div class="donation-amounts">
                  <div class="donation-amount" onclick="app.proceedToDonation('https://buy.stripe.com/28E5kwbWi9xT1AH7e25kk02')">
                    <div class="price">$5</div>
                    <p>Coffee ☕</p>
                  </div>
                  <div class="donation-amount" onclick="app.proceedToDonation('https://buy.stripe.com/6oU3cogcyh0l5QX0PE5kk00')">
                    <div class="price">$25</div>
                    <p>Support 💪</p>
                  </div>
                  <div class="donation-amount" onclick="app.proceedToDonation('https://buy.stripe.com/8x27sE7G239v4MT69Y5kk01')">
                    <div class="price">$50</div>
                    <p>Generous ✨</p>
                  </div>
                  <div class="donation-amount" onclick="app.proceedToDonation('https://buy.stripe.com/5kQ7sEd0mcK5bbh41Q5kk03')">
                    <div class="price">Custom</div>
                    <p>Your Amount 💖</p>
                  </div>
                </div>
                
                <div class="donation-buttons">
                  <button class="skip-btn" onclick="app.closeDonationModal()">Continue Free</button>
                </div>
                
                <div class="donation-footer">
                  <p>🙏 Your generosity keeps this service free for everyone</p>
                  <p>🔒 Secure payment processing • Tax-deductible receipt</p>
                </div>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      };

      const closeDonationModal = () => {
        const modal = document.querySelector('.donation-modal');
        if (modal) modal.remove();
      };

      const proceedToDonation = (url) => {
        if (url && typeof url === 'string') {
          window.open(url, '_blank', 'noopener');
          closeDonationModal();
          
          setTimeout(() => {
            alert('Thank you for your generous heart! Your support helps keep PocketPilgrim free for everyone. 🙏');
          }, 1000);
        }
      };

      // Initialize
      const init = () => {
        initDOM();
        setupTextarea(dom.heroInput);
        setupTextarea(dom.chatInput);
        updateSendButton();
      };

      // Public API
      return {
        init,
        goHome,
        handleLandingSubmit,
        startChat,
        newChat,
        useExample,
        sendMessage,
        showDonationModal,
        closeDonationModal,
        proceedToDonation
      };
    })();

    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', app.init);
  </script>
</body>
</html>